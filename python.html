<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Python</title>

<script src="site_libs/header-attrs-2.14/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
<link rel="shortcut icon" href="static/favicon.ico" type="image/x-icon" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">geocoug</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="rstudio.html">RStudio</a>
</li>
<li>
  <a href="python.html">Python</a>
</li>
<li>
  <a href="dm.html">Data Management</a>
</li>
<li>
  <a href="cli.html">CLI</a>
</li>
<li>
  <a href="dbms.html">DBMS</a>
</li>
<li>
  <a href="tools.html">Tools</a>
</li>
<li>
  <a href="health.html">Health</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://geocoug.github.io">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://www.linkedin.com/in/caleb-grant-04b098101">
    <span class="fab fa-linkedin fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Python</h1>

</div>


<hr />
<p><strong>Credit</strong> - Many of the Python methods below are taken
directly from an <a
href="https://splinterofthesingularity.blogspot.com/search/label/Python">RDN
blog</a></p>
<hr />
<pre class="r fold-show"><code>Sys.setenv(RETICULATE_PYTHON = &quot;/Users/cgrant/envs/dev/bin/python&quot;)
library(reticulate)
py_config()</code></pre>
<pre><code>## python:         /Users/cgrant/envs/dev/bin/python
## libpython:      /opt/homebrew/opt/python@3.9/Frameworks/Python.framework/Versions/3.9/lib/python3.9/config-3.9-darwin/libpython3.9.dylib
## pythonhome:     /Users/cgrant/envs/dev:/Users/cgrant/envs/dev
## version:        3.9.13 (main, May 24 2022, 21:13:51)  [Clang 13.1.6 (clang-1316.0.21.2)]
## numpy:          /Users/cgrant/envs/dev/lib/python3.9/site-packages/numpy
## numpy_version:  1.22.3
## 
## NOTE: Python version was forced by RETICULATE_PYTHON</code></pre>
<div id="regular-expressions" class="section level1">
<h1>Regular Expressions</h1>
<ul>
<li><a
href="https://www.rexegg.com/regex-quickstart.html">Quickstart</a></li>
<li><a href="https://regex101.com/">Regex101</a></li>
</ul>
<div id="cheat-sheet" class="section level2">
<h2>Cheat Sheet</h2>
<div id="metacharacters-need-to-be-escaped" class="section level3">
<h3>MetaCharacters (Need to be escaped)</h3>
<p><code>. ^ $ * + ? { } [ ] \ | ( )</code></p>
</div>
<div id="characters" class="section level3">
<h3>Characters</h3>
<p><code>.</code> - Any Character Except New Line<br> <code>\d</code> -
Digit (0-9)<br> <code>\D</code> - Not a Digit (0-9)<br> <code>\w</code>
- Word Character (a-z, A-Z, 0-9, _)<br> <code>\W</code> - Not a Word
Character<br> <code>\s</code> - Whitespace (space, tab, newline)<br>
<code>\S</code> - Not Whitespace (space, tab, newline)<br></p>
</div>
<div id="character-classes" class="section level3">
<h3>Character Classes</h3>
<p><code>[]</code> - Matches Characters in brackets<br>
<code>[^ ]</code> - Matches Characters NOT in brackets<br>
<code>[a-z]</code> - Any lowercase character between a and z<br>
<code>[A-Z]</code> - Any UPPERCASE character between A and Z<br></p>
</div>
<div id="quantifiers" class="section level3">
<h3>Quantifiers</h3>
<p><code>*</code> - 0 or More<br> <code>+</code> - 1 or More<br>
<code>?</code> - 0 or One<br> <code>{3}</code> - Exact Number<br>
<code>{3,4}</code> - Range of Numbers (Minimum, Maximum)<br>
<code>{3,}</code> - At least 3<br></p>
</div>
<div id="anchors-boundaries" class="section level3">
<h3>Anchors &amp; Boundaries</h3>
<p><code>\b</code> - Word Boundary<br> <code>\B</code> - Not a Word
Boundary<br> <code>^</code> - Beginning of a String<br> <code>$</code> -
End of a String<br></p>
</div>
<div id="logic" class="section level3">
<h3>Logic</h3>
<p><code>|</code> - Either Or<br> <code>( )</code> - Group<br>
<code>\1</code> - Contents of group 1<br></p>
</div>
<div id="white-space" class="section level3">
<h3>White-space</h3>
<p><code>\t</code> - Tab<br> <code>\r</code> - Carriage return<br>
<code>\n</code> - New line<br></p>
<hr />
<pre class="python fold-show"><code>import re

text_string = &#39;&#39;&#39;
Hello world

8001234567
800-321-7654
900.987.6543

some.email@email.com
mycompany@company.net
wierd-12-address-4@somedomain.blah
&#39;&#39;&#39;

pattern = re.compile(r&#39;[0-9]{3}[.-]?[0-9]{3}[.-]?[0-9]{4}&#39;)
matches = re.finditer(pattern, text_string)

for match in matches:
  print(match)
  print(match.span())
  print(text_string[match.start():match.end()])</code></pre>
<pre><code>## &lt;re.Match object; span=(14, 24), match=&#39;8001234567&#39;&gt;
## (14, 24)
## 8001234567
## &lt;re.Match object; span=(25, 37), match=&#39;800-321-7654&#39;&gt;
## (25, 37)
## 800-321-7654
## &lt;re.Match object; span=(38, 50), match=&#39;900.987.6543&#39;&gt;
## (38, 50)
## 900.987.6543</code></pre>
</div>
</div>
</div>
<div id="oop-basics" class="section level1">
<h1>OOP Basics</h1>
<pre class="python fold-show"><code>class Employee:
    &quot;&quot;&quot;Create an employee object with relevant attributes.&quot;&quot;&quot;

    annual_raise_pct = 0.04
    employee_no = 1

    def __init__(self, first_name, last_name, position, years_employed=1):
        &quot;&quot;&quot;Function called when new object is initiated.&quot;&quot;&quot;
        self.first_name = first_name
        self.last_name = last_name
        self.position = position
        self.years_employed = years_employed
        self.employee_number = Employee.employee_no
        self.email = self.first_name + &quot;.&quot; + self.last_name + &quot;@company.com&quot;
        self.salary = self.calculate_salary()
        Employee.employee_no += 1

    def starting_salary(self):
        &quot;&quot;&quot;Return the starting salary for each position at company&quot;&quot;&quot;
        if self.position == &quot;HR&quot;:
            return 25000
        elif self.position == &quot;Management&quot;:
            return 50000
        elif self.position == &quot;Developer&quot;:
            return 100000
        elif self.position == &quot;CEO&quot;:
            return 200000
        else:
            return None

    def calculate_salary(self):
        salary = self.starting_salary()
        for year in range(self.years_employed):
            salary = int(salary + (salary * Employee.annual_raise_pct))
        return salary

    def __repr__(self):
        &quot;&quot;&quot;Create representational object string&quot;&quot;&quot;
        return f&quot;&quot;&quot;Employee(first_name = {self.first_name}, last_name = {self.last_name}, position = {self.position}, years_employed = {self.years_employed})&quot;&quot;&quot;


current_employees = [
    Employee(&quot;Geo&quot;, &quot;Coug&quot;, &quot;Developer&quot;, 6),
    Employee(&quot;Jane&quot;, &quot;Doe&quot;, &quot;HR&quot;, 4),
    Employee(&quot;John&quot;, &quot;Doe&quot;, &quot;Management&quot;, 15),
    Employee(&quot;Bob&quot;, &quot;Loblaw&quot;, &quot;CEO&quot;, 24),
]

for e in current_employees:
    print(f&quot;Employee Number: {e.employee_number}&quot;)
    print(e)
    print(&quot;Email:&quot;, e.email)
    print(&quot;Salary: ${:,}\n&quot;.format(e.salary))</code></pre>
<pre><code>## Employee Number: 1
## Employee(first_name = Geo, last_name = Coug, position = Developer, years_employed = 6)
## Email: Geo.Coug@company.com
## Salary: $126,530
## 
## Employee Number: 2
## Employee(first_name = Jane, last_name = Doe, position = HR, years_employed = 4)
## Email: Jane.Doe@company.com
## Salary: $29,245
## 
## Employee Number: 3
## Employee(first_name = John, last_name = Doe, position = Management, years_employed = 15)
## Email: John.Doe@company.com
## Salary: $90,039
## 
## Employee Number: 4
## Employee(first_name = Bob, last_name = Loblaw, position = CEO, years_employed = 24)
## Email: Bob.Loblaw@company.com
## Salary: $512,645</code></pre>
</div>
<div id="csv-files" class="section level1">
<h1>CSV Files</h1>
<div id="db-and-file-objects" class="section level2">
<h2>DB and File Objects</h2>
<pre class="python fold-show"><code>import csv


class CsvFile(object):
    &quot;&quot;&quot;CsvFile class automatically opens a file and creates a CSV reader, reads the first row containing column headers, and stores those headers so that they can be used to construct the INSERT statement.&quot;&quot;&quot;

    def __init__(self, filename):
        self.fn = filename
        self.f = None
        self.open()
        self.rdr = csv.reader(self.f)
        self.headers = next(self.rdr)

    def open(self):
        if self.f is None:
            mode = &quot;rb&quot; if sys.version_info &lt; (3,) else &quot;r&quot;
            self.f = open(self.fn, mode)

    def reader(self):
        return self.rdr

    def close(self):
        self.rdr = None
        self.f.close()
        self.f = None


class Database(object):
    &quot;&quot;&quot;The Database class and subclasses provide a database connection for each type of DBMS, and a method to construct an INSERT statement for a given CsvFile object, using that DBMS&#39;s parameter substitution string.  The conn_info argument is a dictionary containing the host name, user name, and password.&quot;&quot;&quot;

    def __init__(self, conn_info):
        self.paramstr = &quot;%s&quot;
        self.conn = None

    def insert_sql(self, tablename, csvfile):
        return &quot;insert into %s (%s) values (%s);&quot; % (
            tablename,
            &quot;,&quot;.join(csvfile.headers),
            &quot;,&quot;.join([self.paramstr] * len(csvfile.headers)),
        )


class PgDb(Database):
    &quot;&quot;&quot;Connection object for PostgreSQL&quot;&quot;&quot;

    def __init__(self, conn_info):
        self.db_type = &quot;p&quot;
        import psycopg2

        self.paramstr = &quot;%s&quot;
        connstr = (
            &quot;host=%(server)s dbname=%(db)s user=%(user)s password=%(pw)s&quot; % conn_info
        )
        self.conn = psycopg2.connect(connstr)


class MariaDb(Database):
    &quot;&quot;&quot;Connection object for Maria DB&quot;&quot;&quot;

    def __init__(self, conn_info):
        self.db_type = &quot;m&quot;
        import pymysql

        self.paramstr = &quot;%s&quot;
        self.conn = pymysql.connect(
            host=conn_info[&quot;server&quot;],
            database=conn_info[&quot;db&quot;],
            port=3306,
            user=conn_info[&quot;user&quot;],
            password=conn_info[&quot;pw&quot;],
        )</code></pre>
</div>
<div id="import-functions" class="section level2">
<h2>Import Functions</h2>
<div id="postgres-copy-command" class="section level3">
<h3>Postgres COPY command</h3>
<pre class="python fold-show"><code>def postgres_copy(csvfile, db):
    curs = db.conn.cursor()
    rf = open(csvfile.fn, &quot;rt&quot;)
    # Read and discard headers
    hdrs = rf.readline()
    copy_cmd = &quot;copy copy_test from stdin with (format csv)&quot;
    curs.copy_expert(copy_cmd, rf)</code></pre>
</div>
<div id="row-by-row-reading-and-writing" class="section level3">
<h3>Row-by-row reading and writing</h3>
<pre class="python fold-show"><code>def simple_copy(csvfile, db):
    ins_sql = db.insert_sql(&#39;copy_test&#39;, csvfile)
    curs = db.conn.cursor()
    rdr = csvfile.reader()
    for line in rdr:
        curs.execute(ins_sql, clean_line(line))
        db.conn.commit()</code></pre>
</div>
<div id="buffered-reading-and-writing" class="section level3">
<h3>Buffered reading and writing</h3>
<pre class="python fold-show"><code>def buffer1_copy(csvfile, db, buflines):
    ins_sql = db.insert_sql(&quot;copy_test&quot;, csvfile)
    curs = db.conn.cursor()
    rdr = csvfile.reader()
    eof = False
    while True:
        b = []
        for j in range(buflines):
            try:
                line = next(rdr)
            except StopIteration:
                eof = True
            else:
                b.append(clean_line(line))
        if len(b) &gt; 0:
            curs.executemany(ins_sql, b)
            if eof:
                break
    db.conn.commit()</code></pre>
</div>
</div>
</div>
<div id="dbms-data-types" class="section level1">
<h1>DBMS Data Types</h1>
<table style="width:100%;">
<colgroup>
<col width="15%" />
<col width="14%" />
<col width="12%" />
<col width="17%" />
<col width="14%" />
<col width="15%" />
<col width="10%" />
</colgroup>
<thead>
<tr class="header">
<th>Data Type</th>
<th>Postgres</th>
<th>MariaDB</th>
<th>SQL Server</th>
<th>Firebird</th>
<th>MS-Access</th>
<th>SQLite</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Timestamp with time zone</td>
<td>1184</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>Timestamp</td>
<td>1184</td>
<td>7</td>
<td></td>
<td>type ‘datetime.datetime’</td>
<td></td>
<td>None</td>
</tr>
<tr class="odd">
<td>Datetime</td>
<td></td>
<td>12</td>
<td>class ‘datetime.datetime’</td>
<td></td>
<td>class ‘datetime.datetime’</td>
<td>None</td>
</tr>
<tr class="even">
<td>Date</td>
<td>1082</td>
<td>10</td>
<td>class ‘datetime.date’</td>
<td>type ‘datetime.date’</td>
<td>class ‘datetime.datetime’</td>
<td>None</td>
</tr>
<tr class="odd">
<td>Time</td>
<td>1083</td>
<td>11</td>
<td>class ‘datetime.time’</td>
<td>type ‘datetime.time’</td>
<td>class ‘datetime.datetime’</td>
<td>None</td>
</tr>
<tr class="even">
<td>Boolean</td>
<td>16</td>
<td>16</td>
<td>class ‘bool’</td>
<td></td>
<td>class ‘bool’</td>
<td></td>
</tr>
<tr class="odd">
<td>Small integer</td>
<td>21</td>
<td>1</td>
<td>class ‘int’</td>
<td></td>
<td>class ‘int’</td>
<td></td>
</tr>
<tr class="even">
<td>Integer</td>
<td>23</td>
<td>2</td>
<td>class ‘int’</td>
<td>type ‘int’</td>
<td>class ‘int’</td>
<td>None</td>
</tr>
<tr class="odd">
<td>Long integer</td>
<td>20</td>
<td>3</td>
<td>class ‘int’</td>
<td>type ‘long’</td>
<td></td>
<td>None</td>
</tr>
<tr class="even">
<td>Single</td>
<td>701</td>
<td>4</td>
<td>class ‘float’</td>
<td>type ‘float’</td>
<td>class ‘float’</td>
<td>None</td>
</tr>
<tr class="odd">
<td>Double precision</td>
<td>701</td>
<td>5</td>
<td>class ‘float’</td>
<td>type ‘float’</td>
<td>class ‘float’</td>
<td>None</td>
</tr>
<tr class="even">
<td>Decimal</td>
<td>1700</td>
<td>0</td>
<td>class ‘decimal.Decimal’</td>
<td>class ‘decimal.Decimal’</td>
<td></td>
<td>None</td>
</tr>
<tr class="odd">
<td>Currency</td>
<td>790</td>
<td></td>
<td></td>
<td>class ‘decimal.Decimal’</td>
<td>class ‘decimal.Decimal’</td>
<td></td>
</tr>
<tr class="even">
<td>Character</td>
<td>1042</td>
<td></td>
<td>class ‘str’</td>
<td>type ‘str’</td>
<td>class ‘str’</td>
<td>None</td>
</tr>
<tr class="odd">
<td>Character varying</td>
<td>1043</td>
<td>15</td>
<td>class ‘str’</td>
<td>type ‘str’</td>
<td>class ‘str’</td>
<td>None</td>
</tr>
<tr class="even">
<td>Text</td>
<td>25</td>
<td></td>
<td>class ‘str’</td>
<td>type ‘str’</td>
<td>class ‘str’</td>
<td>None</td>
</tr>
<tr class="odd">
<td>Binary / BLOB</td>
<td>17</td>
<td>249,250,251,252</td>
<td>class ‘bytearray’</td>
<td>type ‘str’</td>
<td>type ‘bytearray’</td>
<td>None</td>
</tr>
</tbody>
</table>
</div>
<div id="dbms-libraries" class="section level1">
<h1>DBMS Libraries</h1>
<ul>
<li>Postgres: <code>psycopg2</code></li>
<li>MariaDB: <code>pymysql</code></li>
<li>SQL Server: <code>pyodbc</code></li>
<li>Firebird: <code>fdb</code></li>
<li>MS-Access: <code>pyodbc</code></li>
<li>SQLite: <code>sqlite3</code></li>
</ul>
</div>
<div id="db-table-dependencies" class="section level1">
<h1>DB Table Dependencies</h1>
<pre class="python fold-show"><code>def dependency_order(dep_list):
    rem_tables = list(set([t[0] for t in dep_list] + [t[1] for t in dep_list]))
    rem_dep = copy.copy(dep_list)
    sortkey = 1
    ret_list = []
    while len(rem_dep) &gt; 0:
        tbls = [tbl for tbl in rem_tables if tbl not in [dep[0] for dep in rem_dep]]
        ret_list.extend([(tb, sortkey) for tb in tbls])
        rem_tables = [tbl for tbl in rem_tables if tbl not in tbls]
        rem_dep = [dep for dep in rem_dep if dep[1] not in tbls]
        sortkey += 1
    if len(rem_tables) &gt; 0:
        ret_list.extend([(tb, sortkey) for tb in rem_tables])
    ret_list.sort(cmp=lambda x, y: cmp(x[1], y[1]))
    return [item[0] for item in ret_list]</code></pre>
</div>
<div id="csv-sniffer" class="section level1">
<h1>CSV Sniffer</h1>
<pre class="python fold-show"><code>import re


class CsvDiagError(Exception):
    def __init__(self, msg):
        self.value = msg

    def __str__(self):
        return self.value


class CsvLine:
    escchar = &quot;\\&quot;

    def __init__(self, line_text):
        self.text = line_text
        self.delim_counts = {}
        self.item_errors = []  # A list of error messages.

    def __str__(self):
        return &quot;; &quot;.join(
            [
                &quot;Text: &lt;&lt;%s&gt;&gt;&quot; % self.text,
                &quot;Delimiter counts: &lt;&lt;%s&gt;&gt;&quot;
                % &quot;, &quot;.join(
                    [
                        &quot;%s: %d&quot; % (k, self.delim_counts[k])
                        for k in self.delim_counts.keys()
                    ]
                ),
            ]
        )

    def count_delim(self, delim):
        # If the delimiter is a space, consider multiple spaces to be equivalent
        # to a single delimiter, split on the space(s), and consider the delimiter
        # count to be one fewer than the items returned.
        if delim == &quot; &quot;:
            self.delim_counts[delim] = max(0, len(re.split(r&quot; +&quot;, self.text)) - 1)
        else:
            self.delim_counts[delim] = self.text.count(delim)

    def delim_count(self, delim):
        return self.delim_counts[delim]

    def _well_quoted(self, element, qchar):
        # A well-quoted element has either no quotes, a quote on each end and none
        # in the middle, or quotes on both ends and every internal quote is either
        # doubled or escaped.
        # Returns a tuple of three booleans; the first indicates whether the element is
        # well-quoted, the second indicates whether the quote character is used
        # at all, and the third indicates whether the escape character is used.
        if qchar not in element:
            return (True, False, False)
        if len(element) == 0:
            return (True, False, False)
        if element[0] == qchar and element[-1] == qchar and qchar not in element[1:-1]:
            return (True, True, False)
        # The element has quotes; if it doesn&#39;t have one on each end, it is not well-quoted.
        if not (element[0] == qchar and element[-1] == qchar):
            return (False, True, False)
        e = element[1:-1]
        # If there are no quotes left after removing doubled quotes, this is well-quoted.
        if qchar not in e.replace(qchar + qchar, &quot;&quot;):
            return (True, True, False)
        # if there are no quotes left after removing escaped quotes, this is well-quoted.
        if qchar not in e.replace(self.escchar + qchar, &quot;&quot;):
            return (True, True, True)
        return (False, True, False)

    def record_format_error(self, pos_no, errmsg):
        self.item_errors.append(&quot;%s in position %d.&quot; % (errmsg, pos_no))

    def items(self, delim, qchar):
        # Parses the line into a list of items, breaking it at delimiters that are not
        # within quoted stretches.  (This is a almost CSV parser, for valid delim and qchar,
        # except that it does not eliminate quote characters or reduce escaped quotes.)
        self.item_errors = []
        if qchar is None:
            if delim is None:
                return self.text
            else:
                if delim == &quot; &quot;:
                    return re.split(r&quot; +&quot;, self.text)
                else:
                    return self.text.split(delim)
        elements = []  # The list of items on the line that will be returned.
        eat_multiple_delims = delim == &quot; &quot;
        # States of the FSM:
        # _IN_QUOTED: An opening quote has been seen, but no closing quote encountered.
        #  Actions / transition:
        #   quote: save char in escape buffer / _ESCAPED
        #   esc_char : save char in escape buffer / _ESCAPED
        #   delimiter: save char in element buffer / _IN_QUOTED
        #   other: save char in element buffer / _IN_QUOTED
        # _ESCAPED: An escape character has been seen while _IN_QUOTED (and is in the escape buffer).
        #  Actions / transitions
        #   quote: save escape buffer in element buffer, empty escape buffer,
        #    save char in element buffer / _IN_QUOTED
        #   delimiter: save escape buffer in element buffer, empty escape buffer,
        #    save element buffer, empty element buffer / _BETWEEN
        #   other: save escape buffer in element buffer, empty escape buffer,
        #    save char in element buffer / _IN_QUOTED
        # _QUOTE_IN_QUOTED: A quote has been seen while _IN_QUOTED (and is in the escape buffer).
        #  Actions / transitions
        #   quote: save escape buffer in element buffer, empty escape buffer,
        #    save char in element buffer / _IN_QUOTED
        #   delimiter: save escape buffer in element buffer, empty escape buffer,
        #    save element buffer, empty element buffer / _DELIMITED
        #   other: save escape buffer in element buffer, empty escape buffer,
        #    save char in element buffer / _IN_QUOTED
        #     (An &#39;other&#39; character in this position represents a bad format:
        #     a quote not followed by another quote or a delimiter.)
        # _IN_UNQUOTED: A non-delimiter, non-quote has been seen.
        #  Actions / transitions
        #   quote: save char in element buffer / _IN_UNQUOTED
        #    (This represents a bad format.)
        #   delimiter: save element buffer, empty element buffer / _DELIMITED
        #   other: save char in element buffer / _IN_UNQUOTED
        # _BETWEEN: Not in an element, and a delimiter not seen.  This is the starting state,
        #   and the state following a closing quote but before a delimiter is seen.
        #  Actions / transition:
        #   quote: save char in element buffer / _IN_QUOTED
        #   delimiter: save element buffer, empty element buffer / _DELIMITED
        #    (The element buffer should be empty, representing a null data item.)
        #   other: save char in element buffer / _IN_UNQUOTED
        # _DELIMITED: A delimiter has been seen while not in a quoted item.
        #  Actions / transition:
        #   quote: save char in element buffer / _IN_QUOTED
        #   delimiter: if eat_multiple: no action / _DELIMITED
        #     if not eat_multiple: save element buffer, empty element buffer / _DELIMITED
        #   other: save char in element buffer / _IN_UNQUOTED
        # At end of line: save escape buffer in element buffer, save element buffer.  For a well-formed
        # line, these should be empty, but they may not be.
        #
        # Define the state constants, which will also be used as indexes into an execution vector.
        (
            _IN_QUOTED,
            _ESCAPED,
            _QUOTE_IN_QUOTED,
            _IN_UNQUOTED,
            _BETWEEN,
            _DELIMITED,
        ) = range(6)
        #
        # Because of Python 2.7&#39;s scoping rules:
        # * The escape buffer and current element are defined as mutable objects that will have their
        #  first elements modified, rather than as string variables.  (Python 2.x does not allow
        #  modification of a variable in an enclosing scope that is not the global scope, but
        #  mutable objects like lists can be altered.  Another approach would be to implement this
        #  as a class and use instance variables.)
        # * The action functions return the next state rather than assigning it directly to the &#39;state&#39; variable.
        esc_buf = [&quot;&quot;]
        current_element = [&quot;&quot;]

        def in_quoted():
            if c == self.escchar:
                esc_buf[0] = c
                return _ESCAPED
            elif c == qchar:
                esc_buf[0] = c
                return _QUOTE_IN_QUOTED
            else:
                current_element[0] += c
                return _IN_QUOTED

        def escaped():
            if c == delim:
                current_element[0] += esc_buf[0]
                esc_buf[0] = &quot;&quot;
                elements.append(current_element[0])
                current_element[0] = &quot;&quot;
                return _BETWEEN
            else:
                current_element[0] += esc_buf[0]
                esc_buf[0] = &quot;&quot;
                current_element[0] += c
                return _IN_QUOTED

        def quote_in_quoted():
            if c == qchar:
                current_element[0] += esc_buf[0]
                esc_buf[0] = &quot;&quot;
                current_element[0] += c
                return _IN_QUOTED
            elif c == delim:
                current_element[0] += esc_buf[0]
                esc_buf[0] = &quot;&quot;
                elements.append(current_element[0])
                current_element[0] = &quot;&quot;
                return _DELIMITED
            else:
                current_element[0] += esc_buf[0]
                esc_buf[0] = &quot;&quot;
                current_element[0] += c
                self.record_format_error(
                    i + 1, &quot;Unexpected character following a closing quote&quot;
                )
                return _IN_QUOTED

        def in_unquoted():
            if c == delim:
                elements.append(current_element[0])
                current_element[0] = &quot;&quot;
                return _DELIMITED
            else:
                current_element[0] += c
                return _IN_UNQUOTED

        def between():
            if c == qchar:
                current_element[0] += c
                return _IN_QUOTED
            elif c == delim:
                elements.append(current_element[0])
                current_element[0] = &quot;&quot;
                return _DELIMITED
            else:
                current_element[0] += c
                return _IN_UNQUOTED

        def delimited():
            if c == qchar:
                current_element[0] += c
                return _IN_QUOTED
            elif c == delim:
                if not eat_multiple_delims:
                    elements.append(current_element[0])
                    current_element[0] = &quot;&quot;
                return _DELIMITED
            else:
                current_element[0] += c
                return _IN_UNQUOTED

        # Functions in the execution vector must be ordered identically to the
        # indexes represented by the state constants.
        exec_vector = [
            in_quoted,
            escaped,
            quote_in_quoted,
            in_unquoted,
            between,
            delimited,
        ]
        # Set the starting state.
        state = _BETWEEN
        # Process the line of text.
        for i, c in enumerate(self.text):
            state = exec_vector[state]()
        # Process the end-of-line condition.
        if len(esc_buf[0]) &gt; 0:
            current_element[0] += esc_buf[0]
        if len(current_element[0]) &gt; 0:
            elements.append(current_element[0])
        return elements

    def well_quoted_line(self, delim, qchar):
        # Returns a tuple of boolean, int, and boolean, indicating: 1) whether the line is
        # well-quoted, 2) the number of elements for which the quote character is used,
        # and 3) whether the escape character is used.
        wq = [self._well_quoted(el, qchar) for el in self.items(delim, qchar)]
        return (
            all([b[0] for b in wq]),
            sum([b[1] for b in wq]),
            any([b[2] for b in wq]),
        )


def diagnose_delim(linestream, possible_delimiters=None, possible_quotechars=None):
    # Returns a tuple consisting of the delimiter, quote character, and escape
    # character for quote characters within elements of a line.  All may be None.
    # If the escape character is not None, it will be u&quot;\&quot;.
    # Arguments:
    # * linestream: An iterable file-like object with a &#39;next()&#39; method that returns lines of text
    #  as bytes or unicode.
    # * possible_delimiters: A list of single characters that might be used to separate items on
    #  a line.  If not specified, the default consists of tab, comma, semicolon, and vertical rule.
    #  If a space character is included, multiple space characters will be treated as a single
    #  delimiter--so it&#39;s best if there are no missing values on space-delimited lines, though
    #  that is not necessarily a fatal flaw unless there is a very high fraction of missing values.
    # * possible_quotechars: A list of single characters that might be used to quote items on
    #  a line.  If not specified, the default consists of single and double quotes.
    if not possible_delimiters:
        possible_delimiters = [&quot;\t&quot;, &quot;,&quot;, &quot;;&quot;, &quot;|&quot;]
    if not possible_quotechars:
        possible_quotechars = [&#39;&quot;&#39;, &quot;&#39;&quot;]
    lines = []
    for i in range(100):
        try:
            ln = linestream.next()
        except StopIteration:
            break
        except:
            raise
        while len(ln) &gt; 0 and ln[-1] in (&quot;\n&quot;, &quot;\r&quot;):
            ln = ln[:-1]
        if len(ln) &gt; 0:
            lines.append(CsvLine(ln))
    if len(lines) == 0:
        raise CsvDiagError(&quot;CSV diagnosis error: no lines read&quot;)
    for ln in lines:
        for d in possible_delimiters:
            ln.count_delim(d)
    # For each delimiter, find the minimum number of delimiters found on any line, and the number of lines
    # with that minimum number
    delim_stats = {}
    for d in possible_delimiters:
        dcounts = [ln.delim_count(d) for ln in lines]
        min_count = min(dcounts)
        delim_stats[d] = (min_count, dcounts.count(min_count))
    # Remove delimiters that were never found.
    for k in delim_stats.keys():
        if delim_stats[k][0] == 0:
            del delim_stats[k]

    def all_well_quoted(delim, qchar):
        # Returns a tuple of boolean, int, and boolean indicating: 1) whether the line is
        # well-quoted, 2) the total number of lines and elements for which the quote character
        # is used, and 3) the escape character used.
        wq = [l.well_quoted_line(delim, qchar) for l in lines]
        return (
            all([b[0] for b in wq]),
            sum([b[1] for b in wq]),
            CsvLine.escchar if any([b[2] for b in wq]) else None,
        )

    def eval_quotes(delim):
        # Returns a tuple of the form to be returned by &#39;diagnose_delim()&#39;.
        ok_quotes = {}
        for q in possible_quotechars:
            allwq = all_well_quoted(delim, q)
            if allwq[0]:
                ok_quotes[q] = (allwq[1], allwq[2])
        if len(ok_quotes) == 0:
            return (delim, None, None)  # No quotes, no escapechar
        else:
            max_use = max([v[0] for v in ok_quotes.values()])
            if max_use == 0:
                return (delim, None, None)
            # If multiple quote characters have the same usage, return (arbitrarily) the first one.
            for q in ok_quotes.keys():
                if ok_quotes[q][0] == max_use:
                    return (delim, q, ok_quotes[q][1])

    if len(delim_stats) == 0:
        # None of the delimiters were found.  Some other delimiter may apply,
        # or the input may contain a single value on each line.
        # Identify possible quote characters.
        return eval_quotes(None)
    else:
        if len(delim_stats) &gt; 1:
            # If one of them is a space, prefer the non-space
            if &quot; &quot; in delim_stats.keys():
                del delim_stats[&quot; &quot;]
        if len(delim_stats) == 1:
            return eval_quotes(delim_stats.keys()[0])
        # Assign weights to the delimiters.  The weight is the square of the minimum number of delimiters
        # on a line times the number of lines with that delimiter.
        delim_wts = {}
        for d in delim_stats.keys():
            delim_wts[d] = delim_stats[d][0] ** 2 * delim_stats[d][1]
        # Evaluate quote usage for each delimiter, from most heavily weighted to least.
        # Return the first good pair where the quote character is used.
        delim_order = sorted(delim_wts, key=delim_wts.get, reverse=True)
        for d in delim_order:
            quote_check = eval_quotes(d)
            if quote_check[0] and quote_check[1]:
                return quote_check
        # There are no delimiters for which quotes are OK.
        return (delim_order[0], None, None)
    # Should never get here
    raise CsvDiagError(&quot;CSV diagnosis error: an untested set of conditions are present&quot;)</code></pre>
</div>
<div id="vs-code-config" class="section level1">
<h1>VS Code Config</h1>
<pre class="json fold-show"><code>{
  &quot;python.linting.flake8Path&quot;: &quot;flake8&quot;,
  &quot;python.terminal.activateEnvironment&quot;: true,
  &quot;workbench.settings.editor&quot;: &quot;json&quot;,
  &quot;prettier.tabWidth&quot;: 2,
  &quot;terminal.integrated.defaultProfile.osx&quot;: &quot;zsh&quot;,
  &quot;python.analysis.typeCheckingMode&quot;: &quot;basic&quot;,
  &quot;prettier.bracketSpacing&quot;: true,
  &quot;editor.formatOnSave&quot;: true,
  &quot;workbench.iconTheme&quot;: &quot;material-icon-theme&quot;,
  &quot;python.linting.pylintEnabled&quot;: false,
  &quot;prettier.quoteProps&quot;: &quot;consistent&quot;,
  &quot;window.title&quot;: &quot;${activeEditorLong}${separator}${rootName}&quot;,
  &quot;python.formatting.provider&quot;: &quot;black&quot;,
  &quot;editor.accessibilitySupport&quot;: &quot;off&quot;,
  &quot;terminal.external.osxExec&quot;: &quot;iTerm.app&quot;,
  &quot;python.formatting.blackPath&quot;: &quot;black&quot;,
  &quot;editor.minimap.enabled&quot;: false,
  &quot;python.linting.banditEnabled&quot;: false,
  &quot;editor.bracketPairColorization.enabled&quot;: true,
  &quot;editor.tabCompletion&quot;: &quot;on&quot;,
  &quot;python.linting.lintOnSave&quot;: true,
  &quot;explorer.confirmDelete&quot;: false,
  &quot;editor.codeActionsOnSave&quot;: {
    &quot;source.organizeImports&quot;: true
  },
  &quot;editor.scrollBeyondLastLine&quot;: false,
  &quot;workbench.settings.openDefaultSettings&quot;: true,
  &quot;editor.linkedEditing&quot;: true,
  &quot;terminal.integrated.inheritEnv&quot;: false,
  &quot;terminal.integrated.fontFamily&quot;: &quot;&#39;MesloLGS NF&#39;&quot;,
  &quot;python.linting.enabled&quot;: true,
  &quot;workbench.settings.useSplitJSON&quot;: true,
  &quot;terminal.integrated.env.osx&quot;: {
    &quot;FIG_NEW_SESSION&quot;: &quot;1&quot;
  },
  &quot;python.linting.flake8Enabled&quot;: true,
  &quot;prettier.jsxBracketSameLine&quot;: true,
  &quot;python.linting.flake8Args&quot;: [
    &quot;--max-line-length=88&quot;
    // &quot;--ignore=E402,F841,F401,E302,E305&quot;,
  ],
  &quot;workbench.startupEditor&quot;: &quot;none&quot;,
  &quot;editor.wordWrap&quot;: &quot;on&quot;,
}</code></pre>
</div>

<hr>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
